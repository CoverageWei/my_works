
select * from qyy_mid_online.user_term_learn_duration where type='1d' and tag='unit_learn' and member_id=1020572548 and term_id=400000000075600;

1020572548	400000000075600	126342	2017-03-27	1d	unit_learn
1020572548	400000000075600	84228	2017-03-28	1d	unit_learn
1020572548	400000000075600	63171	2017-03-30	1d	unit_learn
1020572548	400000000075600	21057	2017-03-31	1d	unit_learn
1020572548	400000000075600	63171	2017-04-01	1d	unit_learn
1020572548	400000000075600	63171	2017-04-02	1d	unit_learn
1020572548	400000000075600	21057	2017-04-03	1d	unit_learn
1020572548	400000000075600	21057	2017-04-08	1d	unit_learn
1020572548	400000000075600	42114	2017-04-09	1d	unit_learn
1020572548	400000000075600	21057	2017-04-27	1d	unit_learn
1020572548	400000000075600	21057	2017-04-30	1d	unit_learn
1020572548	400000000075600	63171	2017-05-08	1d	unit_learn
1020572548	400000000075600	84228	2017-05-09	1d	unit_learn
1020572548	400000000075600	63171	2017-05-10	1d	unit_learn
1020572548	400000000075600	84228	2017-05-12	1d	unit_learn
1020572548	400000000075600	21057	2017-05-13	1d	unit_learn
1020572548	400000000075600	21057	2017-05-14	1d	unit_learn
1020572548	400000000075600	42114	2017-05-15	1d	unit_learn
1020572548	400000000075600	168456	2017-05-16	1d	unit_learn
1020572548	400000000075600	126342	2017-05-17	1d	unit_learn
1020572548	400000000075600	42114	2017-05-18	1d	unit_learn
1020572548	400000000075600	21057	2017-05-21	1d	unit_learn
1020572548	400000000075600	105285	2017-05-23	1d	unit_learn




select * from qyy_mid_online.user_term_learn_duration where type='1d' and tag='all_learn' and member_id=1020572548 and term_id=400000000075600;

1020572548	400000000075600	105285	2017-05-23	1d	all_learn



select * from qyy_mid_online.user_term_learn_duration where type='td' and tag='unit_learn' and member_id=1020572548 and term_id=400000000075600;

1020572548	400000000075600	63171	2017-03-25	td	unit_learn
1020572548	400000000075600	63171	2017-03-26	td	unit_learn
1020572548	400000000075600	189513	2017-03-27	td	unit_learn
1020572548	400000000075600	273741	2017-03-28	td	unit_learn
1020572548	400000000075600	273741	2017-03-29	td	unit_learn
1020572548	400000000075600	336912	2017-03-30	td	unit_learn
1020572548	400000000075600	357969	2017-03-31	td	unit_learn
1020572548	400000000075600	421140	2017-04-01	td	unit_learn
1020572548	400000000075600	484311	2017-04-02	td	unit_learn
1020572548	400000000075600	505368	2017-04-03	td	unit_learn
1020572548	400000000075600	505368	2017-04-04	td	unit_learn
1020572548	400000000075600	505368	2017-04-05	td	unit_learn
1020572548	400000000075600	505368	2017-04-06	td	unit_learn
1020572548	400000000075600	505368	2017-04-07	td	unit_learn
1020572548	400000000075600	526425	2017-04-08	td	unit_learn
1020572548	400000000075600	568539	2017-04-09	td	unit_learn
1020572548	400000000075600	568539	2017-04-10	td	unit_learn
1020572548	400000000075600	568539	2017-04-11	td	unit_learn
1020572548	400000000075600	568539	2017-04-12	td	unit_learn
1020572548	400000000075600	568539	2017-04-13	td	unit_learn
1020572548	400000000075600	568539	2017-04-14	td	unit_learn
1020572548	400000000075600	568539	2017-04-15	td	unit_learn
1020572548	400000000075600	568539	2017-04-16	td	unit_learn
1020572548	400000000075600	568539	2017-04-17	td	unit_learn
1020572548	400000000075600	568539	2017-04-18	td	unit_learn
1020572548	400000000075600	568539	2017-04-19	td	unit_learn
1020572548	400000000075600	568539	2017-04-20	td	unit_learn
1020572548	400000000075600	568539	2017-04-21	td	unit_learn
1020572548	400000000075600	568539	2017-04-22	td	unit_learn
1020572548	400000000075600	568539	2017-04-23	td	unit_learn
1020572548	400000000075600	568539	2017-04-24	td	unit_learn
1020572548	400000000075600	568539	2017-04-25	td	unit_learn
1020572548	400000000075600	568539	2017-04-26	td	unit_learn
1020572548	400000000075600	589596	2017-04-27	td	unit_learn
1020572548	400000000075600	589596	2017-04-28	td	unit_learn
1020572548	400000000075600	589596	2017-04-29	td	unit_learn
1020572548	400000000075600	610653	2017-04-30	td	unit_learn
1020572548	400000000075600	610653	2017-05-01	td	unit_learn
1020572548	400000000075600	610653	2017-05-02	td	unit_learn
1020572548	400000000075600	610653	2017-05-03	td	unit_learn
1020572548	400000000075600	610653	2017-05-04	td	unit_learn
1020572548	400000000075600	610653	2017-05-05	td	unit_learn
1020572548	400000000075600	610653	2017-05-06	td	unit_learn
1020572548	400000000075600	610653	2017-05-07	td	unit_learn
1020572548	400000000075600	673824	2017-05-08	td	unit_learn
1020572548	400000000075600	758052	2017-05-09	td	unit_learn
1020572548	400000000075600	821223	2017-05-10	td	unit_learn
1020572548	400000000075600	821223	2017-05-11	td	unit_learn
1020572548	400000000075600	905451	2017-05-12	td	unit_learn
1020572548	400000000075600	926508	2017-05-13	td	unit_learn
1020572548	400000000075600	947565	2017-05-14	td	unit_learn
1020572548	400000000075600	989679	2017-05-15	td	unit_learn
1020572548	400000000075600	1158135	2017-05-16	td	unit_learn
1020572548	400000000075600	1284477	2017-05-17	td	unit_learn
1020572548	400000000075600	1326591	2017-05-18	td	unit_learn
1020572548	400000000075600	1326591	2017-05-19	td	unit_learn
1020572548	400000000075600	1326591	2017-05-20	td	unit_learn
1020572548	400000000075600	1347648	2017-05-21	td	unit_learn
1020572548	400000000075600	1347648	2017-05-22	td	unit_learn
1020572548	400000000075600	1452933	2017-05-23	td	unit_learn
1020572548	400000000075600	1452933	2017-05-24	td	unit_learn
1020572548	400000000075600	1452933	2017-05-25	td	unit_learn
1020572548	400000000075600	1452933	2017-05-26	td	unit_learn
1020572548	400000000075600	1452933	2017-05-27	td	unit_learn
1020572548	400000000075600	1452933	2017-05-28	td	unit_learn
1020572548	400000000075600	1452933	2017-05-29	td	unit_learn
1020572548	400000000075600	1452933	2017-05-30	td	unit_learn
1020572548	400000000075600	1452933	2017-05-31	td	unit_learn




select * from qyy_mid_online.user_term_learn_duration where type='td' and tag='all_learn' and member_id=1020572548 and term_id=400000000075600;

1020572548	400000000075600	21057	2017-05-22	td	all_learn
1020572548	400000000075600	126342	2017-05-23	td	all_learn
1020572548	400000000075600	126342	2017-05-24	td	all_learn
1020572548	400000000075600	126342	2017-05-25	td	all_learn
1020572548	400000000075600	126342	2017-05-26	td	all_learn
1020572548	400000000075600	126342	2017-05-27	td	all_learn
1020572548	400000000075600	126342	2017-05-28	td	all_learn
1020572548	400000000075600	126342	2017-05-29	td	all_learn
1020572548	400000000075600	126342	2017-05-30	td	all_learn
1020572548	400000000075600	126342	2017-05-31	td	all_learn



移动端 user_learn_record 类型日志上线是 5.21号，5.21号之前 只有 lesson_unit_learn_record 类型日志；
修数据的时候 线上总时长是 从5.21号之后计算的，而 5.21 号之前的 lesson_unit_learn_record 类型日志的数据 没有被计算进 总的线上学习时长内；





select * from qyy_mid_online.user_term_learn_duration where type='1d' and tag='unit_learn' and member_id=1020572548 and term_id=400000000115769;

1020572548	400000000115769	241043	2017-03-31	1d	unit_learn
1020572548	400000000115769	723129	2017-04-01	1d	unit_learn
1020572548	400000000115769	723129	2017-04-02	1d	unit_learn
1020572548	400000000115769	241043	2017-04-03	1d	unit_learn
1020572548	400000000115769	241043	2017-04-08	1d	unit_learn
1020572548	400000000115769	482086	2017-04-09	1d	unit_learn
1020572548	400000000115769	241043	2017-04-27	1d	unit_learn
1020572548	400000000115769	241043	2017-04-30	1d	unit_learn
1020572548	400000000115769	723129	2017-05-08	1d	unit_learn
1020572548	400000000115769	964172	2017-05-09	1d	unit_learn
1020572548	400000000115769	723129	2017-05-10	1d	unit_learn
1020572548	400000000115769	964172	2017-05-12	1d	unit_learn
1020572548	400000000115769	241043	2017-05-13	1d	unit_learn
1020572548	400000000115769	241043	2017-05-14	1d	unit_learn
1020572548	400000000115769	482086	2017-05-15	1d	unit_learn
1020572548	400000000115769	1928344	2017-05-16	1d	unit_learn
1020572548	400000000115769	1446258	2017-05-17	1d	unit_learn
1020572548	400000000115769	482086	2017-05-18	1d	unit_learn
1020572548	400000000115769	241043	2017-05-21	1d	unit_learn
1020572548	400000000115769	1205215	2017-05-23	1d	unit_learn





select * from qyy_mid_online.user_term_learn_duration where type='1d' and tag='all_learn' and member_id=1020572548 and term_id=400000000115769;

1020572548	400000000115769	1205215	2017-05-23	1d	all_learn



select * from qyy_mid_online.user_term_learn_duration where type='td' and tag='unit_learn' and member_id=1020572548 and term_id=400000000115769;

1020572548	400000000115769	964172	2017-03-31	td	unit_learn
1020572548	400000000115769	1687301	2017-04-01	td	unit_learn
1020572548	400000000115769	2410430	2017-04-02	td	unit_learn
1020572548	400000000115769	2651473	2017-04-03	td	unit_learn
1020572548	400000000115769	2651473	2017-04-04	td	unit_learn
1020572548	400000000115769	2651473	2017-04-05	td	unit_learn
1020572548	400000000115769	2651473	2017-04-06	td	unit_learn
1020572548	400000000115769	2651473	2017-04-07	td	unit_learn
1020572548	400000000115769	2892516	2017-04-08	td	unit_learn
1020572548	400000000115769	3374602	2017-04-09	td	unit_learn
1020572548	400000000115769	3374602	2017-04-10	td	unit_learn
1020572548	400000000115769	3374602	2017-04-11	td	unit_learn
1020572548	400000000115769	3374602	2017-04-12	td	unit_learn
1020572548	400000000115769	3374602	2017-04-13	td	unit_learn
1020572548	400000000115769	3374602	2017-04-14	td	unit_learn
1020572548	400000000115769	3374602	2017-04-15	td	unit_learn
1020572548	400000000115769	3374602	2017-04-16	td	unit_learn
1020572548	400000000115769	3374602	2017-04-17	td	unit_learn
1020572548	400000000115769	3374602	2017-04-18	td	unit_learn
1020572548	400000000115769	3374602	2017-04-19	td	unit_learn
1020572548	400000000115769	3374602	2017-04-20	td	unit_learn
1020572548	400000000115769	3374602	2017-04-21	td	unit_learn
1020572548	400000000115769	3374602	2017-04-22	td	unit_learn
1020572548	400000000115769	3374602	2017-04-23	td	unit_learn
1020572548	400000000115769	3374602	2017-04-24	td	unit_learn
1020572548	400000000115769	3374602	2017-04-25	td	unit_learn
1020572548	400000000115769	3374602	2017-04-26	td	unit_learn
1020572548	400000000115769	3615645	2017-04-27	td	unit_learn
1020572548	400000000115769	3615645	2017-04-28	td	unit_learn
1020572548	400000000115769	3615645	2017-04-29	td	unit_learn
1020572548	400000000115769	3856688	2017-04-30	td	unit_learn
1020572548	400000000115769	3856688	2017-05-01	td	unit_learn
1020572548	400000000115769	3856688	2017-05-02	td	unit_learn
1020572548	400000000115769	3856688	2017-05-03	td	unit_learn
1020572548	400000000115769	3856688	2017-05-04	td	unit_learn
1020572548	400000000115769	3856688	2017-05-05	td	unit_learn
1020572548	400000000115769	3856688	2017-05-06	td	unit_learn
1020572548	400000000115769	3856688	2017-05-07	td	unit_learn
1020572548	400000000115769	4579817	2017-05-08	td	unit_learn
1020572548	400000000115769	5543989	2017-05-09	td	unit_learn
1020572548	400000000115769	6267118	2017-05-10	td	unit_learn
1020572548	400000000115769	6267118	2017-05-11	td	unit_learn
1020572548	400000000115769	7231290	2017-05-12	td	unit_learn
1020572548	400000000115769	7472333	2017-05-13	td	unit_learn
1020572548	400000000115769	7713376	2017-05-14	td	unit_learn
1020572548	400000000115769	8195462	2017-05-15	td	unit_learn
1020572548	400000000115769	10123806	2017-05-16	td	unit_learn
1020572548	400000000115769	11570064	2017-05-17	td	unit_learn
1020572548	400000000115769	12052150	2017-05-18	td	unit_learn
1020572548	400000000115769	12052150	2017-05-19	td	unit_learn
1020572548	400000000115769	12052150	2017-05-20	td	unit_learn
1020572548	400000000115769	12293193	2017-05-21	td	unit_learn
1020572548	400000000115769	12293193	2017-05-22	td	unit_learn
1020572548	400000000115769	13498408	2017-05-23	td	unit_learn
1020572548	400000000115769	13498408	2017-05-24	td	unit_learn
1020572548	400000000115769	13498408	2017-05-25	td	unit_learn
1020572548	400000000115769	13498408	2017-05-26	td	unit_learn
1020572548	400000000115769	13498408	2017-05-27	td	unit_learn
1020572548	400000000115769	13498408	2017-05-28	td	unit_learn
1020572548	400000000115769	13498408	2017-05-29	td	unit_learn
1020572548	400000000115769	13498408	2017-05-30	td	unit_learn
1020572548	400000000115769	13498408	2017-05-31	td	unit_learn




select * from qyy_mid_online.user_term_learn_duration where type='td' and tag='all_learn' and member_id=1020572548 and term_id=400000000115769;

1020572548	400000000115769	241043	2017-05-22	td	all_learn
1020572548	400000000115769	1446258	2017-05-23	td	all_learn
1020572548	400000000115769	1446258	2017-05-24	td	all_learn
1020572548	400000000115769	1446258	2017-05-25	td	all_learn
1020572548	400000000115769	1446258	2017-05-26	td	all_learn
1020572548	400000000115769	1446258	2017-05-27	td	all_learn
1020572548	400000000115769	1446258	2017-05-28	td	all_learn
1020572548	400000000115769	1446258	2017-05-29	td	all_learn
1020572548	400000000115769	1446258	2017-05-30	td	all_learn
1020572548	400000000115769	1446258	2017-05-31	td	all_learn










select term_unit_learn_count,term_unit_duration,member_id,term_id,provider_id from qyy_output_online.s2_term_learn_progress_stat where day = "2017-06-01" and term_unit_duration > 0 and term_unit_learn_count is NULL limit 20 ;


select * from qyy_mid_online.term_learn_progress_stat_kv where day="2017-06-01" and category='term_unit_learn_count' and member_id=1017867585 and term_id=400000001001048;


select * from qyy_mid_online.user_term_learn_duration where type='1d' and tag='unit_learn' and member_id=1017867585 and term_id=400000001001048;


1017867585	400000001001048	24820	2017-05-19	1d	unit_learn


select * from qyy_dbload_online.s2_lesson_content_learn where day="2017-05-19" and member_id=1017867585 and term_id=400000001001048  limit 10;





select * from qyy_mid_online.user_term_learn_duration where type='td' and tag='unit_learn' and day= "2017-06-05" and member_id=1027007736 and term_id=400000001195049;


